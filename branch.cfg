cfgs:
  main:
    branches:
    - master
    inherit:
      external-dns-management:
        base_definition:
          repo: null
          steps:
            build:
              image: golang:1.11.6
              output_dir: binary
            check:
              image: golang:1.11.6
            test:
              image: golang:1.11.6
          traits:
            publish:
              dockerimages:
                controller-manager:
                  dockerfile: build/Dockerfile
                  image: eu.gcr.io/gardener-project/dns-controller-manager
                  inputs:
                    repos:
                      source: null
                    steps:
                      build: null
                  registry: gcr-readwrite
            version:
              inject_effective_version: true
              preprocess: inject-branch-name
        variants:
          head-update:
            traits:
              component_descriptor: null
          pull-request:
            traits:
              component_descriptor: null
              pull-request: null
          release:
            traits:
              component_descriptor: null
              release:
                nextversion: bump_minor
              version:
                preprocess: finalize
  patch:
    branches:
    - patch
    inherit:
      external-dns-management:
        base_definition:
          repo: null
          steps:
            build:
              image: golang:1.11.6
              output_dir: binary
            check:
              image: golang:1.11.6
            test:
              image: golang:1.11.6
          traits:
            publish:
              dockerimages:
                controller-manager:
                  dockerfile: build/Dockerfile
                  image: eu.gcr.io/gardener-project/dns-controller-manager
                  inputs:
                    repos:
                      source: null
                    steps:
                      build: null
                  registry: gcr-readwrite
            version:
              inject_effective_version: true
              preprocess: inject-branch-name
        variants:
          head-update:
            traits:
              component_descriptor: null
          release:
            traits:
              release:
                nextversion: bump_patch
              version:
                preprocess: finalize
