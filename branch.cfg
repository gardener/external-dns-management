cfgs:
  dev:
    branches:
    - dev
    inherit:
      external-dns-management:
        base_definition:
          repo: null
          steps:
            build:
              image: golang:1.19.5
              output_dir: binary
            check:
              image: golang:1.19.5
            integrationtest:
              image: golang:1.19.5
            test:
              image: golang:1.19.5
          traits:
            publish:
              dockerimages:
                dns-controller-manager:
                  dockerfile: build/Dockerfile
                  image: eu.gcr.io/gardener-project/dns-controller-manager
                  inputs:
                    repos:
                      source: null
                    steps:
                      build: null
                  registry: gcr-readwrite
            version:
              inject_effective_version: true
              preprocess: inject-branch-name
        jobs:
          head-update:
            traits:
              component_descriptor:
                retention_policy: clean-snapshots
  main:
    branches:
    - master
    inherit:
      external-dns-management:
        base_definition:
          repo: null
          steps:
            build:
              image: golang:1.19.5
              output_dir: binary
            check:
              image: golang:1.19.5
            integrationtest:
              image: golang:1.19.5
            test:
              image: golang:1.19.5
          traits:
            publish:
              dockerimages:
                dns-controller-manager:
                  dockerfile: build/Dockerfile
                  image: eu.gcr.io/gardener-project/dns-controller-manager
                  inputs:
                    repos:
                      source: null
                    steps:
                      build: null
                  registry: gcr-readwrite
            version:
              inject_effective_version: true
              preprocess: inject-branch-name
        jobs:
          head-update:
            traits:
              component_descriptor:
                retention_policy: clean-snapshots
              draft_release: null
          patch-release:
            traits:
              component_descriptor: null
              release:
                next_version_callback: .ci/prepare_release
                nextversion: bump_patch
                release_callback: .ci/prepare_release
              slack:
                channel_cfgs:
                  internal_scp_workspace:
                    channel_name: C9CEBQPGE
                    slack_cfg_name: scp_workspace
                default_channel: internal_scp_workspace
              version:
                preprocess: finalize
          pull-request:
            traits:
              component_descriptor: null
              pull-request: null
              version:
                preprocess: inject-commit-hash
          release:
            traits:
              component_descriptor: null
              release:
                next_version_callback: .ci/prepare_release
                nextversion: bump_minor
                release_callback: .ci/prepare_release
              slack:
                channel_cfgs:
                  internal_scp_workspace:
                    channel_name: C9CEBQPGE
                    slack_cfg_name: scp_workspace
                default_channel: internal_scp_workspace
              version:
                preprocess: finalize
          verbatim-release:
            traits:
              component_descriptor: null
              release:
                nextversion: noop
                release_callback: .ci/prepare_release
              slack:
                channel_cfgs:
                  internal_scp_workspace:
                    channel_name: C9CEBQPGE
                    slack_cfg_name: scp_workspace
                default_channel: internal_scp_workspace
              version:
                preprocess: noop
  patch:
    branches:
    - patch
    inherit:
      external-dns-management:
        base_definition:
          repo: null
          steps:
            build:
              image: golang:1.19.5
              output_dir: binary
            check:
              image: golang:1.19.5
            integrationtest:
              image: golang:1.19.5
            test:
              image: golang:1.19.5
          traits:
            publish:
              dockerimages:
                dns-controller-manager:
                  dockerfile: build/Dockerfile
                  image: eu.gcr.io/gardener-project/dns-controller-manager
                  inputs:
                    repos:
                      source: null
                    steps:
                      build: null
                  registry: gcr-readwrite
            version:
              inject_effective_version: true
              preprocess: inject-branch-name
        jobs:
          head-update:
            traits:
              component_descriptor:
                retention_policy: clean-snapshots
          patch-release:
            traits:
              component_descriptor: null
              release:
                next_version_callback: .ci/prepare_release
                nextversion: bump_patch
                release_callback: .ci/prepare_release
              slack:
                channel_cfgs:
                  internal_scp_workspace:
                    channel_name: C9CEBQPGE
                    slack_cfg_name: scp_workspace
                default_channel: internal_scp_workspace
              version:
                preprocess: finalize
